language: cpp
sudo: required
env: 
  global:
    - OPENBLAS_NUM_THREADS=1
matrix:
  include:
    - os: linux
      dist: xenial
      compiler: gcc
      env: 
        - CXX="g++-5"
        - CC="gcc-5"
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-5
            - g++-5
            - gfortran-5
            - libopenblas-dev
            - fftw3-dev
 
    - os: linux
      dist: xenial
      compiler: gcc
      env: 
        - CXX="g++-8"
        - CC="gcc-8"
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-8
            - g++-8
            - gfortran-8
            - libopenblas-dev
            - fftw3-dev
            
    - os: linux
      dist: xenial
      compiler: gcc
      env: 
        - CXX="g++-9"
        - CC="gcc-9"
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-9
            - g++-9
            - gfortran-9
            - libopenblas-dev
            - fftw3-dev

before_install:
    - sudo unlink /usr/bin/gcc && sudo ln -s /usr/bin/${CC} /usr/bin/gcc
    - sudo unlink /usr/bin/g++ && sudo ln -s /usr/bin/${CXX} /usr/bin/g++
    - which gcc && gcc --version
    - which g++ && g++ --version
    - lscpu

install: true

script:
    - cd ./bin/ && mv -f makefile.dbg makefile
    - make
    
after_script:
    - ./slabcc -v
    - ldd -v slabcc
    
notifications:
    email: false
