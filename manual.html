<!--?xml version="1.0" encoding="utf-8" ?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>kpcc ReadMe</title>
<style type="text/css">

/*
 * basic.css
 * ~~~~~~~~~
 *
 * Sphinx stylesheet -- basic theme.
 *
 * :copyright: Copyright 2007-2010 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 */

/* -- main layout ----------------------------------------------------------- */

div.clearer {
    clear: both;
}

/* -- relbar ---------------------------------------------------------------- */

div.related {
    width: 100%;
    font-size: 90%;
}

div.related h3 {
    display: none;
}

div.related ul {
    margin: 0;
    padding: 0 0 0 10px;
    list-style: none;
}

div.related li {
    display: inline;
}

div.related li.right {
    float: right;
    margin-right: 5px;
}

/* -- sidebar --------------------------------------------------------------- */

div.sphinxsidebarwrapper {
    padding: 10px 5px 0 10px;
}

div.sphinxsidebar {
    float: left;
    width: 230px;
    margin-left: -100%;
    font-size: 90%;
}

div.sphinxsidebar ul {
    list-style: none;
}

div.sphinxsidebar ul ul,
div.sphinxsidebar ul.want-points {
    margin-left: 20px;
    list-style: square;
}

div.sphinxsidebar ul ul {
    margin-top: 0;
    margin-bottom: 0;
}

div.sphinxsidebar form {
    margin-top: 10px;
}

div.sphinxsidebar input {
    border: 1px solid #98dbcc;
    font-family: sans-serif;
    font-size: 1em;
}

img {
    border: 0;
}

/* -- search page ----------------------------------------------------------- */

ul.search {
    margin: 10px 0 0 20px;
    padding: 0;
}

ul.search li {
    padding: 5px 0 5px 20px;
    background-image: url(file.png);
    background-repeat: no-repeat;
    background-position: 0 7px;
}

ul.search li a {
    font-weight: bold;
}

ul.search li div.context {
    color: #888;
    margin: 2px 0 0 30px;
    text-align: left;
}

ul.keywordmatches li.goodmatch a {
    font-weight: bold;
}

/* -- index page ------------------------------------------------------------ */

table.contentstable {
    width: 90%;
}

table.contentstable p.biglink {
    line-height: 150%;
}

a.biglink {
    font-size: 1.3em;
}

span.linkdescr {
    font-style: italic;
    padding-top: 5px;
    font-size: 90%;
}

/* -- general index --------------------------------------------------------- */

table.indextable {
    width: 100%;
}

table.indextable td {
    text-align: left;
    vertical-align: top;
}

table.indextable dl, table.indextable dd {
    margin-top: 0;
    margin-bottom: 0;
}

table.indextable tr.pcap {
    height: 10px;
}

table.indextable tr.cap {
    margin-top: 10px;
    background-color: #f2f2f2;
}

img.toggler {
    margin-right: 3px;
    margin-top: 3px;
    cursor: pointer;
}

div.modindex-jumpbox {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    margin: 1em 0 1em 0;
    padding: 0.4em;
}

div.genindex-jumpbox {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    margin: 1em 0 1em 0;
    padding: 0.4em;
}

/* -- general body styles --------------------------------------------------- */

a.headerlink {
    visibility: hidden;
}

h1:hover > a.headerlink,
h2:hover > a.headerlink,
h3:hover > a.headerlink,
h4:hover > a.headerlink,
h5:hover > a.headerlink,
h6:hover > a.headerlink,
dt:hover > a.headerlink {
    visibility: visible;
}

div.body p.caption {
    text-align: inherit;
}

div.body td {
    text-align: left;
}

.field-list ul {
    padding-left: 1em;
}

.first {
    margin-top: 0 !important;
}

p.rubric {
    margin-top: 30px;
    font-weight: bold;
}

.align-left {
    text-align: left;
}

.align-center {
    clear: both;
    text-align: center;
}

.align-right {
    text-align: right;
}

/* -- sidebars -------------------------------------------------------------- */

div.sidebar {
    margin: 0 0 0.5em 1em;
    border: 1px solid #ddb;
    padding: 7px 7px 0 7px;
    background-color: #ffe;
    width: 40%;
    float: right;
}

p.sidebar-title {
    font-weight: bold;
}

/* -- topics ---------------------------------------------------------------- */

div.topic {
    border: 1px solid #ccc;
    padding: 7px 7px 0 7px;
    margin: 10px 0 10px 0;
}

p.topic-title {
    font-size: 1.1em;
    font-weight: bold;
    margin-top: 10px;
}

/* -- admonitions ----------------------------------------------------------- */

div.admonition {
    margin-top: 10px;
    margin-bottom: 10px;
    padding: 7px;
}

div.admonition dt {
    font-weight: bold;
}

div.admonition dl {
    margin-bottom: 0;
}

p.admonition-title {
    margin: 0px 10px 5px 0px;
    font-weight: bold;
}

div.body p.centered {
    text-align: center;
    margin-top: 25px;
}

/* -- tables ---------------------------------------------------------------- */

table.docutils {
    border: 0;
    border-collapse: collapse;
}

table.docutils td, table.docutils th {
    padding: 1px 8px 1px 5px;
    border-top: 0;
    border-left: 0;
    border-right: 0;
    border-bottom: 1px solid #aaa;
}

table.field-list td, table.field-list th {
    border: 0 !important;
}

table.footnote td, table.footnote th {
    border: 0 !important;
}

th {
    text-align: left;
    padding-right: 5px;
}

table.citation {
    border-left: solid 1px gray;
    margin-left: 1px;
}

table.citation td {
    border-bottom: none;
}

/* -- other body styles ----------------------------------------------------- */

ol.arabic {
    list-style: decimal;
}

ol.loweralpha {
    list-style: lower-alpha;
}

ol.upperalpha {
    list-style: upper-alpha;
}

ol.lowerroman {
    list-style: lower-roman;
}

ol.upperroman {
    list-style: upper-roman;
}

dl {
    margin-bottom: 15px;
}

dd p {
    margin-top: 0px;
}

dd ul, dd table {
    margin-bottom: 10px;
}

dd {
    margin-top: 3px;
    margin-bottom: 10px;
    margin-left: 30px;
}

dt:target, .highlighted {
    background-color: #fbe54e;
}

dl.glossary dt {
    font-weight: bold;
    font-size: 1.1em;
}

.field-list ul {
    margin: 0;
    padding-left: 1em;
}

.field-list p {
    margin: 0;
}

.refcount {
    color: #060;
}

.optional {
    font-size: 1.3em;
}

.versionmodified {
    font-style: italic;
}

.system-message {
    background-color: #fda;
    padding: 5px;
    border: 3px solid red;
}

.footnote:target  {
    background-color: #ffa
}

.line-block {
    display: block;
    margin-top: 1em;
    margin-bottom: 1em;
}

.line-block .line-block {
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 1.5em;
}

.guilabel, .menuselection {
    font-family: sans-serif;
}

.accelerator {
    text-decoration: underline;
}

.classifier {
    font-style: oblique;
}

/* -- code displays --------------------------------------------------------- */

pre {
    overflow: auto;
}

td.linenos pre {
    padding: 5px 0px;
    border: 0;
    background-color: transparent;
    color: #aaa;
}

table.highlighttable {
    margin-left: 0.5em;
}

table.highlighttable td {
    padding: 0 0.5em 0 0.5em;
}

tt.descname {
    background-color: transparent;
    font-weight: bold;
    font-size: 1.2em;
}

tt.descclassname {
    background-color: transparent;
}

tt.xref, a tt {
    background-color: transparent;
    font-weight: bold;
}

h1 tt, h2 tt, h3 tt, h4 tt, h5 tt, h6 tt {
    background-color: transparent;
}

.viewcode-link {
    float: right;
}

.viewcode-back {
    float: right;
    font-family: sans-serif;
}

div.viewcode-block:target {
    margin: -1px -10px;
    padding: 0 10px;
}

/* -- math display ---------------------------------------------------------- */

img.math {
    vertical-align: middle;
}

div.body div.math p {
    text-align: center;
}

span.eqno {
    float: right;
}

/* -- printout stylesheet --------------------------------------------------- */

@media print {
    div.document,
    div.documentwrapper,
    div.bodywrapper {
        margin: 0 !important;
        width: 100%;
    }

    div.sphinxsidebar,
    div.related,
    div.footer,
    #top-link {
        display: none;
    }
}

</style>
<style type="text/css">

/*
 * nature.css_t
 * ~~~~~~~~~~~~
 *
 * Sphinx stylesheet -- nature theme.
 *
 * :copyright: Copyright 2007-2010 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 */
 
/* -- page layout ----------------------------------------------------------- */
 
body {
    font-family: Arial, sans-serif;
    font-size: 100%;
    /*background-color: #111;*/
    color: #555;
    margin: 0;
    padding: 0;
}

div.documentwrapper {
    float: left;
    width: 100%;
}

div.bodywrapper {
    margin: 0 0 0 230px;
}

hr {
    border: 1px solid #B1B4B6;
}
 
div.document {
    background-color: #eee;
}
 
div.body {
    background-color: #ffffff;
    color: #3E4349;
    padding: 0 30px 30px 30px;
    font-size: 0.9em;
}
 
div.footer {
    color: #555;
    width: 100%;
    padding: 13px 0;
    text-align: center;
    font-size: 75%;
}
 
div.footer a {
    color: #444;
    text-decoration: underline;
}
 
div.related {
    background-color: #6BA81E;
    line-height: 32px;
    color: #fff;
    text-shadow: 0px 1px 0 #444;
    font-size: 0.9em;
}
 
div.related a {
    color: #E2F3CC;
}
 
div.sphinxsidebar {
    font-size: 0.75em;
    line-height: 1.5em;
}

div.sphinxsidebarwrapper{
    padding: 20px 0;
}
 
div.sphinxsidebar h3,
div.sphinxsidebar h4 {
    font-family: Arial, sans-serif;
    color: #222;
    font-size: 1.2em;
    font-weight: normal;
    margin: 0;
    padding: 5px 10px;
    background-color: #ddd;
    text-shadow: 1px 1px 0 white
}

div.sphinxsidebar h4{
    font-size: 1.1em;
}
 
div.sphinxsidebar h3 a {
    color: #444;
}
 
 
div.sphinxsidebar p {
    color: #888;
    padding: 5px 20px;
}
 
div.sphinxsidebar p.topless {
}
 
div.sphinxsidebar ul {
    margin: 10px 20px;
    padding: 0;
    color: #000;
}
 
div.sphinxsidebar a {
    color: #444;
}
 
div.sphinxsidebar input {
    border: 1px solid #ccc;
    font-family: sans-serif;
    font-size: 1em;
}

div.sphinxsidebar input[type=text]{
    margin-left: 20px;
}
 
/* -- body styles ----------------------------------------------------------- */
 
a {
    color: #005B81;
    text-decoration: none;
}
 
a:hover {
    color: #E32E00;
    text-decoration: underline;
}
 
div.body h1,
div.body h2,
div.body h3,
div.body h4,
div.body h5,
div.body h6 {
    font-family: Arial, sans-serif;
    background-color: #BED4EB;
    font-weight: normal;
    color: #212224;
    margin: 30px 0px 10px 0px;
    padding: 5px 0 5px 10px;
    text-shadow: 0px 1px 0 white
}
 
div.body h1 { border-top: 20px solid white; margin-top: 0; font-size: 200%; }
div.body h2 { font-size: 150%; background-color: #C8D5E3; }
div.body h3 { font-size: 120%; background-color: #D8DEE3; }
div.body h4 { font-size: 110%; background-color: #D8DEE3; }
div.body h5 { font-size: 100%; background-color: #D8DEE3; }
div.body h6 { font-size: 100%; background-color: #D8DEE3; }
 
a.headerlink {
    color: #c60f0f;
    font-size: 0.8em;
    padding: 0 4px 0 4px;
    text-decoration: none;
}
 
a.headerlink:hover {
    background-color: #c60f0f;
    color: white;
}
 
div.body p, div.body dd, div.body li {
    line-height: 1.5em;
}
 
div.admonition p.admonition-title + p {
    display: inline;
}

div.highlight{
    background-color: white;
}

div.note {
    background-color: #eee;
    border: 1px solid #ccc;
}
 
div.seealso {
    background-color: #ffc;
    border: 1px solid #ff6;
}
 
div.topic {
    background-color: #eee;
}
 
div.warning {
    background-color: #ffe4e4;
    border: 1px solid #f66;
}
 
p.admonition-title {
    display: inline;
}
 
p.admonition-title:after {
    content: ":";
}
 
pre {
    padding: 10px;
    background-color: White;
    color: #222;
    line-height: 1.2em;
    border: 1px solid #C6C9CB;
    font-size: 1.1em;
    margin: 1.5em 0 1.5em 0;
    -webkit-box-shadow: 1px 1px 1px #d8d8d8;
    -moz-box-shadow: 1px 1px 1px #d8d8d8;
}
 
tt {
    background-color: #ecf0f3;
    color: #222;
    /* padding: 1px 2px; */
    font-size: 1.1em;
    font-family: monospace;
}

.viewcode-back {
    font-family: Arial, sans-serif;
}

div.viewcode-block:target {
    background-color: #f4debf;
    border-top: 1px solid #ac9;
    border-bottom: 1px solid #ac9;
}

p {
	margin: 0;
}

ul li dd {
	margin-top: 0;
}

ul li dl {
	margin-bottom: 0;
}

li dl dd {
	margin-bottom: 0;
}

dd ul {
	padding-left: 0;
}

li dd ul {
	margin-bottom: 0;
}

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fernández
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*/
/* --end--
* CSS file for LaTeX formulas.
*/

/* Formulas */
.formula {
	text-align: center;
	font-family: "Droid Serif", "DejaVu Serif", "STIX", serif;
	margin: 1.2em 0;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
.fraction .fraction {
	font-size: 80%;
	line-height: 100%;
}
span.numerator {
	display: block;
}
span.denominator {
	display: block;
	padding: 0ex;
	border-top: thin solid;
}
sup.numerator, sup.unit {
	font-size: 70%;
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	font-size: 70%;
	vertical-align: -20%;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	font-size: 70%;
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	font-size: 150%;
	vertical-align: top;
}
span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
span.symbol {
	line-height: 125%;
	font-size: 125%;
}
span.bigsymbol {
	line-height: 150%;
	font-size: 150%;
}
span.largesymbol {
	font-size: 175%;
}
span.hugesymbol {
	font-size: 200%;
}
span.scripts {
	display: inline-table;
	vertical-align: middle;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.symbolover {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 100%;
	bottom: 0.5em;
	width: 0px;
}
span.withsymbol {
	display: inline-block;
}
span.symbolunder {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 80%;
	top: 0.3em;
	width: 0px;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	border-collapse: collapse;
	margin: 0em;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0ex;
	border: 0ex;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 99%;
	border: 0ex;
}
/*
* CSS file for LaTeX formulas, extra stuff:
* binomials, vertical braces, stackrel, fonts and colors.
*/

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
span.mathsf, span.textsf {
	font-style: normal;
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-style: normal;
	font-family: serif;
}
span.text, span.textnormal {
	font-style: normal;
}
span.textipa {
	color: #008080;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}


</style>
</head>
<body>
<div class="document">
 <div class="body">

<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="last-updated field"><th class="docinfo-name">Last updated:</th><td class="field-body">29 July 2018</td>
</tr>
<tr><th class="docinfo-name">Version:</th>
<td>0.3</td></tr>
</tbody>
</table>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#introduction" id="id11">1&nbsp;&nbsp;&nbsp;Introduction</a><ul class="auto-toc">
<li><a class="reference internal" href="#algorithm" id="id12">1.1&nbsp;&nbsp;&nbsp;Algorithm</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-start-guide" id="id13">2&nbsp;&nbsp;&nbsp;Quick start guide</a><ul class="auto-toc">
<li><a class="reference internal" href="#example" id="id14">2.1&nbsp;&nbsp;&nbsp;Example</a></li>
<li><a class="reference internal" href="#test-set" id="id15">2.2&nbsp;&nbsp;&nbsp;Test set</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation" id="id16">3&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#command-line-parameters" id="id17">4&nbsp;&nbsp;&nbsp;Command-line parameters</a></li>
<li><a class="reference internal" href="#input-parameters" id="id18">5&nbsp;&nbsp;&nbsp;Input parameters</a></li>
<li><a class="reference internal" href="#results-and-the-generated-files" id="id19">6&nbsp;&nbsp;&nbsp;Results and the generated files</a><ul class="auto-toc">
<li><a class="reference internal" href="#output-files" id="id20">6.1&nbsp;&nbsp;&nbsp;Output files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faq" id="id21">7&nbsp;&nbsp;&nbsp;FAQ</a></li>
<li><a class="reference internal" href="#known-issues-and-limitations" id="id22">8&nbsp;&nbsp;&nbsp;Known issues and limitations</a></li>
<li><a class="reference internal" href="#release-history" id="id23">9&nbsp;&nbsp;&nbsp;Release history</a></li>
<li><a class="reference internal" href="#copyright-and-attributions" id="id24">10&nbsp;&nbsp;&nbsp;Copyright and attributions</a><ul class="auto-toc">
<li><a class="reference internal" href="#included-libraries" id="id25">10.1&nbsp;&nbsp;&nbsp;Included libraries</a></li>
<li><a class="reference internal" href="#linked-libraries" id="id26">10.2&nbsp;&nbsp;&nbsp;Linked libraries</a></li>
<li><a class="reference internal" href="#license" id="id27">10.3&nbsp;&nbsp;&nbsp;License</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id11">1&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>SLABCC calculates an <em>a posteriori</em> energy correction for charged slab models under 3D periodic boundary condition (PBC) based on the method proposed in:</p>
<blockquote>
Hannu-Pekka Komsa and Alfredo Pasquarello, Finite-Size Supercell Correction for Charged Defects at Surfaces and Interfaces, Physical Review Letters 110, 095505 (2013) DOI: <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.110.095505">10.1103/PhysRevLett.110.095505</a> <a class="reference external" href="https://journals.aps.org/prl/supplemental/10.1103/PhysRevLett.110.095505/supplR1.pdf">(Supplements)</a></blockquote>
<p>This method estimates the error in the total energy of the charged models under 3D PBC, due to the excess charge in the real system using a simple Gaussian model.
The model charge is assumed to be embedded in a medium with dielectric-tensor profile depending only on one space axis ε(k) orthogonal to the slab.
The energy correction is calculated as:</p>
<blockquote>
E<sub>corr</sub>  = E<sub>isolated</sub> - E<sub>periodic</sub> - qΔV</blockquote>
<p>where, E<sub>corr</sub> is the total energy correction for the model,
E<sub>periodic</sub> is the energy of the model charge, calculated by solving the periodic Poisson equation. E<sub>isolated</sub> is the energy of the model charge embedded in the dielectric profile and is either determined by extrapolation or analytic (for simple cases).
q is the total extra charge and ΔV is the difference between the potential of the Gaussian model charge system and the DFT calculations.</p>
<div class="line-block">
<div class="line">The code have been initially developed for <a class="reference external" href="http://www.bccms.uni-bremen.de">Bremen Center for Computational Materials Science (BCCMS)</a></div>
</div>
<div class="section" id="algorithm">
<h2><a class="toc-backref" href="#id12">1.1&nbsp;&nbsp;&nbsp;Algorithm</a></h2>
<ul class="simple">
<li>slabcc reads <a class="reference external" href="https://www.vasp.at">VASP</a> output files (CHGCAR and LOCPOT), calculates the extra charge distribution and the potential due to the extra charge. All the input files should correspond to the same geometry.</li>
<li>Extra charge is modeled by a Gaussian charge distribution as:</li>
</ul>
<div class="formula">
<i>ρ</i>(<i>r</i>) = <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>q</i></span><span class="ignored">)/(</span><span class="denominator"><i>σ</i><sup>3</sup>(2<i>π</i>)<sup>3 ⁄ 2</sup></span><span class="ignored">)</span></span>exp<span class="array"><span class="arrayrow"><span class="bracket align-left">⎛</span></span><span class="arrayrow"><span class="bracket align-left">⎝</span></span></span> − <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>r</i><sup>2</sup></span><span class="ignored">)/(</span><span class="denominator">2<i>σ</i><sup>2</sup></span><span class="ignored">)</span></span><span class="array"><span class="arrayrow"><span class="bracket align-right">⎞</span></span><span class="arrayrow"><span class="bracket align-right">⎠</span></span></span>
</div>
<p>which gives a charge distribution normalized to q with standard deviation of σ (<tt class="docutils literal">charge_sigma</tt>).</p>
<ul class="simple">
<li>The generated Gaussian model charge will be embedded in a dielectric medium with profile of the form:</li>
</ul>
<div class="formula">
<i>ϵ</i>(<i>k</i>) = <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>ϵ</i><sub>2</sub> − <i>ϵ</i><sub>1</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="text"> erf</span><span class="array"><span class="arrayrow"><span class="bracket align-left">⎛</span></span><span class="arrayrow"><span class="bracket align-left">⎝</span></span></span><span class="fraction"><span class="ignored">(</span><span class="numerator"><i>k</i> − <i>k</i><sub>0</sub></span><span class="ignored">)/(</span><span class="denominator"><i>β</i></span><span class="ignored">)</span></span><span class="array"><span class="arrayrow"><span class="bracket align-right">⎞</span></span><span class="arrayrow"><span class="bracket align-right">⎠</span></span></span> + <span class="fraction"><span class="ignored">(</span><span class="numerator"><i>ϵ</i><sub>2</sub> + <i>ϵ</i><sub>1</sub></span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span>
</div>
<p>where k<sub>0</sub> is the interface position in k-direction, ε<sub>1</sub> and ε<sub>2</sub> are dielectric tensors on either side of interface (<tt class="docutils literal">diel_in</tt> &amp; <tt class="docutils literal">diel_out</tt>) and β (<tt class="docutils literal">diel_taper</tt>) defines the smoothness of transition assuming anisotrope dielectric tensor as:</p>
<div class="formula">
<i>ϵ</i> = <span class="array"><span class="arrayrow"><span class="bracket align-left">|</span></span><span class="arrayrow"><span class="bracket align-left">|</span></span><span class="arrayrow"><span class="bracket align-left">|</span></span><span class="arrayrow"><span class="bracket align-left">|</span></span><span class="arrayrow"><span class="bracket align-left">|</span></span></span><span class="environment"><span class="arrayrow">
<span class="arraycell align-l">
<i>ϵ</i><sub>11</sub>
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
<i>ϵ</i><sub>22</sub>
</span>
<span class="arraycell align-l">
0
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>
<span class="arraycell align-l">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
0
</span>
<span class="arraycell align-l">
<i>ϵ</i><sub>33</sub>
</span>

</span>
</span><span class="array"><span class="arrayrow"><span class="bracket align-right">|</span></span><span class="arrayrow"><span class="bracket align-right">|</span></span><span class="arrayrow"><span class="bracket align-right">|</span></span><span class="arrayrow"><span class="bracket align-right">|</span></span><span class="arrayrow"><span class="bracket align-right">|</span></span></span>
</div>
<ul class="simple">
<li>The potential due to the charge distribution ρ under 3D PBC embedded in the dielectric medium ε(k) is calculated by solving the Poisson equation in Fourier space:</li>
</ul>
<div class="formula">
<i>ϵ</i>(<i>k</i>)∇<sup>2</sup><i>V</i>(<i>r</i>) + <span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>k</i></span><span class="ignored">)</span></span><i>ϵ</i>(<i>k</i>)<span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>k</i></span><span class="ignored">)</span></span><i>V</i>(<i>r</i>) =  − <i>ρ</i>(<i>r</i>)
</div>
<ul class="simple">
<li>If the <tt class="docutils literal">optimize</tt> parameter is set, a non-linear optimization routine will minimize difference of our calculated V(r) for the model charge and the V resulted from the VASP calculation by changing the position of the model Gaussian charge, its width, and the position of the slab interfaces.</li>
<li>The E<sub>periodic</sub> is calculated as:</li>
</ul>
<div class="formula">
<i>E</i> = <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">2</span><span class="ignored">)</span></span><span class="limits"><span class="limit">⌠</span><span class="limit">⌡</span></span><i>V</i>(<i>r</i>)<i>ρ</i>(<i>r</i>) <i>dr</i>
</div>
<ul class="simple">
<li>E<sub>isolated</sub> is calculated the same way as E<sub>periodic</sub> but with extrapolation of the fixed model charge embedded in an infinitely large dielectric medium.</li>
<li>ΔV is calculated at the position least affected by the model charge.</li>
</ul>
<p>More information about the algorithm and implementation details can be found <a class="reference internal" href="#cite">here</a>.</p>
</div>
</div>
<div class="section" id="quick-start-guide">
<h1><a class="toc-backref" href="#id13">2&nbsp;&nbsp;&nbsp;Quick start guide</a></h1>
<p>To calculate the charge correction slabcc needs the following files:</p>
<ul class="simple">
<li>Input parameters file (default: <code>slabcc.in</code>)</li>
<li>CHGCAR of the neutral system from the VASP calculation (default: <code>CHGCAR.N</code>)</li>
<li>CHGCAR of the charged system from the VASP calculation (default: <code>CHGCAR.C</code>)</li>
<li>LOCPOT of the neutral system from the VASP calculation (default: <code>LOCPOT.N</code>)</li>
<li>LOCPOT of the charged system from the VASP calculation (default: <code>LOCPOT.C</code>)</li>
</ul>
<p>Input parameters file for a slab should minimally include (all in relative scale [0 1]):</p>
<ul class="simple">
<li><tt class="docutils literal">charge_position</tt>: position of the localized charge</li>
<li><tt class="docutils literal">diel_in</tt>: dielectric tensor of the slab</li>
<li><tt class="docutils literal">normal_direction</tt>: direction normal to the surface</li>
<li><tt class="docutils literal">interface</tt>: position of the surfaces of the slab (in the normal direction)</li>
</ul>
<div class="section" id="example">
<h2><a class="toc-backref" href="#id14">2.1&nbsp;&nbsp;&nbsp;Example</a></h2>
<p>The following examples list the <a class="reference internal" href="#input-parameters">input parameters</a> to be defined in <code>slabcc.in</code> file, assuming the VASP outputs (LOCPOT and CHGCAR files) to be in the same directory.</p>
<ol class="arabic">
<li><p class="first"><strong>Minimum input</strong>: The program models the extra charge with a Gaussian charge distribution localized around the position (<tt class="docutils literal">charge_position= 0.24&nbsp; 0.56&nbsp; 0.65</tt>) in a slab model with normal direction of (<tt class="docutils literal">normal_direction = y</tt>) and surfaces at (<tt class="docutils literal">interfaces = 0.25&nbsp; 0.75</tt>). The dielectric tensor inside of the slab is assumed to be isotropic (<tt class="docutils literal">diel_in = 4.8</tt>):</p>
<pre class="literal-block">
charge_position = 0.24  0.56  0.65
diel_in = 4.8
normal_direction = y
interfaces = 0.25 0.75
</pre>
</li>
</ol>
<blockquote>
<p>By default the program will also:</p>
<ul class="simple">
<li>Load the CHGCAR of charged and neutralized systems.</li>
<li>Load the LOCPOT of charged and neutralized systems.</li>
<li>Calculate the total extra charge from the difference between the charged and neutralized CHGCARs.</li>
<li>Optimize the <tt class="docutils literal">charge_position</tt>, <tt class="docutils literal">interfaces</tt> and <tt class="docutils literal">charge_sigma</tt>.</li>
<li>Calculate the total energy correction for the charged system.</li>
<li>Write all the input parameters used for calculation, optimized parameters and the results to output file.</li>
</ul>
</blockquote>
<ol class="arabic" start="2">
<li><p class="first"><strong>Correction with multiple localized Gaussian charges:</strong> If a single charge cannot represent your localized charge properly, you can use multiple Gaussian charges in your model. You have to define the positions of each Gaussian charge as shown in example below:</p>
<pre class="literal-block">
LOCPOT_charged = CHARGED_LOCPOT
LOCPOT_neutral = UNCHARGED_LOCPOT
CHGCAR_charged = CHARGED_CHGCAR
CHGCAR_neutral = UNCHARGED_CHGCAR
charge_position = 0.24  0.56  0.65; 0.20  0.50  0.65
diel_in = 4.8
normal_direction = a
interfaces = 0.25 0.75
</pre>
</li>
<li><p class="first"><strong>Correction for the uniform dielectric medium e.g. bulk models:</strong> You must have the same dielectric tensor inside and outside and turn off the optimization for the interfaces:</p>
<pre class="literal-block">
LOCPOT_charged = CHARGED_LOCPOT
LOCPOT_neutral = UNCHARGED_LOCPOT
CHGCAR_charged = CHARGED_CHGCAR
CHGCAR_neutral = UNCHARGED_CHGCAR
charge_position = 0.24  0.56  0.65
diel_in = 4.8
diel_out = 4.8
optimize_interface = no
</pre>
</li>
</ol>
</div>
<div class="section" id="test-set">
<h2><a class="toc-backref" href="#id15">2.2&nbsp;&nbsp;&nbsp;Test set</a></h2>
<p>You can download a complete test set including input files, input parameters and expected output <a href="https://doi.org/10.5281/zenodo.1323559">here</a>!</p>
</div>
</div>
<div class="section" id="installation">
<h1><a class="toc-backref" href="#id16">3&nbsp;&nbsp;&nbsp;Installation</a></h1>
<ol class="arabic simple">
<li><strong>Prerequisites:</strong></li>
</ol>
<blockquote>
<ol class="arabic simple">
<li><strong>Compiler:</strong> You need a C++ compiler with C++14 standard support (e.g. g++ 5.0 or later, or icpc 15.0 or later)</li>
<li><strong>FFTW:</strong> If you don't have FFTW installed on your system follow the guide on the <a class="reference external" href="http://www.fftw.org/download.html">FFTW website</a></li>
<li><strong>BLAS/OpenBLAS/MKL:</strong> You can use BLAS for the matrix operations inside slabcc but it is highly recommended to use OpenBLAS/MKL instead. If you don't have OpenBLAS/BLAS installed on your system, follow the guide on the <a class="reference external" href="http://www.openblas.net">OpenBLAS website</a></li>
</ol>
</blockquote>
<ol class="arabic" start="2">
<li><p class="first"><strong>Configuration:</strong> You must edit the <code>src/makefile</code> to choose your compiler and add the paths to FFTW and OpenBLAS libraries.</p>
</li>
<li><p class="first"><strong>Compilation:</strong> Run the command <code>make</code> in the <code>src/</code> to compile the slabcc. If you want to statically link the libraries, run:</p>
<pre class="literal-block">
make STATIC=1
</pre>
</li>
</ol>
<blockquote>
(You will need static version of the compiled libraries for static linking)</blockquote>
</div>
<div class="section" id="command-line-parameters">
<h1><a class="toc-backref" href="#id17">4&nbsp;&nbsp;&nbsp;Command-line parameters</a></h1>
<p>You can run slabcc without any additional options. Or you can use the following options to modify its behavior:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></td>
<td>Display usage information (this list)</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-i</span>, <span class="option">--input <var>&lt;input_file&gt;</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>slabcc input file name</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-o</span>, <span class="option">--output <var>&lt;input_file&gt;</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>slabcc output file name</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-m</span>, <span class="option">--manual</span></kbd></td>
<td>Show quick start guide</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-v</span>, <span class="option">--version</span></kbd></td>
<td>Show version and compilation date</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-c</span>, <span class="option">--copyright</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Show copyright information and the attributions</td></tr>
</tbody>
</table>
</div>
<div class="section" id="input-parameters">
<h1><a class="toc-backref" href="#id18">5&nbsp;&nbsp;&nbsp;Input parameters</a></h1>
<p>Kpcc reads all its parameters from the input file (by default: <code>slabcc.in</code>) You can change the input file's name using the <a class="reference internal" href="#command-line-parameters">command-line parameters</a>.
The input file is processed as follows:</p>
<ul class="simple">
<li>Lines starting with # will be treated as comments. Inline comments are also allowed.</li>
<li>Double quotation marks will be removed from the strings</li>
<li>A warning will be issued for any unidentified parameter</li>
<li>All the coordinates must be in fractional form [0-1]</li>
<li>True/False parameters can be also declared as 0/1, on/off, yes/no</li>
<li>Parameter names can be written in small or CAPITAL letters</li>
<li>For vectors and matrices, columns are separated by a “ ”(space), while the rows are separated by a “;” (semicolon)</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="55%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Parameter</th>
<th class="head">Description and options / <tt class="docutils literal">example</tt></th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">charge_fraction</tt></td>
<td><p class="first">Fraction of the extra charge in each localized Gaussian
model charge (in the case of multiple Gaussian charges)</p>
<p class="last"><tt class="docutils literal">charge_fraction = 0.4 0.6</tt></p>
</td>
<td><em>The extra
charge will be
equally divided
among all
positions</em></td>
</tr>
<tr><td><tt class="docutils literal">charge_position</tt></td>
<td><p class="first">Position of the model Gaussian charges</p>
<p><tt class="docutils literal">charge_position = 0.2 0.5 0.3</tt></p>
<p class="last"><tt class="docutils literal">charge_position = 0.2 0.2 0.2; 0.3 0.4 0.3</tt></p>
</td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal">charge_sigma</tt></td>
<td><p class="first">Width of each localized Gaussian charge</p>
<p><tt class="docutils literal">charge_sigma = 1</tt></p>
<p class="last"><tt class="docutils literal">charge_sigma = 1 1.5</tt></p>
</td>
<td>1 (for each
charge)</td>
</tr>
<tr><td><tt class="docutils literal">CHGCAR_charged</tt></td>
<td><p class="first">Charge density file (CHGCAR) of the charged system</p>
<p class="last"><tt class="docutils literal">CHGCAR_charged = CHGCAR1</tt></p>
</td>
<td>CHGCAR.C</td>
</tr>
<tr><td><tt class="docutils literal">CHGCAR_neutral</tt></td>
<td><p class="first">Charge density file (CHGCAR) of the neutral system</p>
<p class="last"><tt class="docutils literal">CHGCAR_neutral = CHGCAR2</tt></p>
</td>
<td>CHGCAR.N</td>
</tr>
<tr><td><tt class="docutils literal">diel_in</tt></td>
<td><p class="first">Diagonal elements of the static dielectric tensor
inside of the slab. If only a single value is given,
all of them will be assumed to be equal.</p>
<p><tt class="docutils literal">diel_in = 3</tt></p>
<p class="last"><tt class="docutils literal">diel_in = 3 4 5</tt></p>
</td>
<td>1</td>
</tr>
<tr><td><tt class="docutils literal">diel_out</tt></td>
<td>Diagonal elements of the static dielectric tensor
outside of the slab</td>
<td>1</td>
</tr>
<tr><td><tt class="docutils literal">diel_taper</tt></td>
<td>The steepness of the transition between diel_in and
diel_out (β in the dielectric profile formula)</td>
<td>1</td>
</tr>
<tr><td><tt class="docutils literal">extrapolate_grid_x</tt></td>
<td><p class="first">Extrapolation grid size multiplier.</p>
<p>extrapolate_grid_x &gt; 1 will use larger grid in the
extrapolations which will increase the accuracy but
requires more memory and computational power.</p>
<p>extrapolate_grid_x = 1 will use the same grid as the
VASP input files</p>
<p>extrapolate_grid_x &lt; 1 will use the smaller grid which
increases the speed and decreases the memory usage but
the energies for the higher orders of extrapolation
may not be accurate!</p>
<p class="last"><tt class="docutils literal">extrapolate_grid_x = 1.8</tt></p>
</td>
<td>1</td>
</tr>
<tr><td><tt class="docutils literal">extrapolate_steps_number</tt></td>
<td>Number of the extrapolation steps in calculation of
E<sub>isolated</sub> <a class="footnote-reference" href="#id6" id="id2">[1]</a></td>
<td>4</td>
</tr>
<tr><td><tt class="docutils literal">extrapolate_steps_size</tt></td>
<td>Size of extrapolation steps with respect to the initial
supercell size</td>
<td>0.5</td>
</tr>
<tr><td><tt class="docutils literal">interfaces</tt></td>
<td><p class="first">Interfaces of the slab in normal direction</p>
<p class="last"><tt class="docutils literal">interfaces = 0.11 0.40</tt></p>
</td>
<td>0.25 0.75</td>
</tr>
<tr><td><tt class="docutils literal">LOCPOT_charged</tt></td>
<td><p class="first">Local potential file (LOCPOT) of the charged system</p>
<p class="last"><tt class="docutils literal">LOCPOT_charged = LOCPOT1</tt></p>
</td>
<td>LOCPOT.C</td>
</tr>
<tr><td><tt class="docutils literal">LOCPOT_neutral</tt></td>
<td><p class="first">Local potential file (LOCPOT) of the neutral system</p>
<p class="last"><tt class="docutils literal">LOCPOT_neutral = LOCPOT2</tt></p>
</td>
<td>LOCPOT.N</td>
</tr>
<tr><td><tt class="docutils literal">normal_direction</tt></td>
<td><p class="first">Normal direction of the slab: one of x/y/z or a/b/c
corresponding to the 1st, 2nd and 3rd vectors in the
input file's cell vectors</p>
<p class="last"><tt class="docutils literal">normal_direction = b</tt></p>
</td>
<td>z</td>
</tr>
<tr><td><tt class="docutils literal">optimize_algorithm</tt></td>
<td><p class="first">Optimization algorithm
(<a class="reference external" href="https://en.wikipedia.org/wiki/BOBYQA">BOBYQA</a> <a class="footnote-reference" href="#id7" id="id3">[2]</a>
/<a class="reference external" href="https://en.wikipedia.org/wiki/COBYLA">COBYLA</a> <a class="footnote-reference" href="#id8" id="id4">[3]</a>)</p>
<p class="last"><tt class="docutils literal">optimize_algorithm = BOBYQA</tt></p>
</td>
<td>COBYLA</td>
</tr>
<tr><td><tt class="docutils literal">optimize_charge</tt></td>
<td><p class="first"><strong>true</strong>: find the optimal values for the model charge
parameters including charge_position, charge_sigma,
and charge_fraction to construct the best model which
mimics the potential obtained from the VASP calculation</p>
<p class="last"><strong>false</strong>: do not change the model charge parameters</p>
</td>
<td>true</td>
</tr>
<tr><td><tt class="docutils literal">optimize_grid_x</tt></td>
<td><p class="first">Optimization grid size multiplier.</p>
<p>optimize_grid_x &gt; 1 will use larger grid in the
extrapolations which will increase the accuracy but
requires more memory and computational power.
[Normally this is not necessary]</p>
<p>optimize_grid_x = 1 will use the same grid as the
VASP input files</p>
<p class="last">optimize_grid_x &lt; 1 will use the smaller grid which
increases the speed and decreases the memory usage but
the parameters obtained using very small values may
not be very accurate!</p>
</td>
<td>0.8</td>
</tr>
<tr><td><tt class="docutils literal">optimize_interfaces</tt></td>
<td><p class="first"><strong>true</strong>: find the optimal values for the model charge
interfaces to construct the best model which mimics
the potential obtained from the VASP calculation</p>
<p class="last"><strong>false</strong>: do not change the position of interfaces in
the model charge</p>
</td>
<td>true</td>
</tr>
<tr><td><tt class="docutils literal">optimize_maxsteps</tt></td>
<td><p class="first">Maximum number of optimization steps</p>
<p class="last"><tt class="docutils literal">optimize_maxsteps = 2000</tt></p>
</td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal">optimize_maxtime</tt></td>
<td><p class="first">Maximum time for optimization in minutes</p>
<p class="last"><tt class="docutils literal">optimize_maxtime = 1440</tt></p>
</td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal">optimize_tolerance</tt></td>
<td>Relative optimization tolerance (convergence criteria)
for mean squared error of the model potential</td>
<td>1e-3</td>
</tr>
<tr><td><tt class="docutils literal">slab_center</tt></td>
<td><p class="first">Center of the slab.
(This point must be inside of the slab)</p>
<p class="last"><tt class="docutils literal">slab_center = 0.2 0.7 0.5</tt></p>
</td>
<td>0.5 0.5 0.5</td>
</tr>
<tr><td><tt class="docutils literal">verbosity</tt></td>
<td><p class="first">Verbosity of the program <a class="footnote-reference" href="#id9" id="id5">[4]</a></p>
<p>0: no extra output: will only write output file and
minimum parameters to standard output</p>
<p>1: display calculation steps and execution walltime
(hh:mm:ss)</p>
<p>2: write extra charge density, extra charge potential
and dielectric profile to disk</p>
<p>3: write planar average to disk</p>
<p class="last">4: show more digits and behind the scene!</p>
</td>
<td>0</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>extrapolating the model to very large order will accumulate errors due to energy calculations for large systems over a coarse grid size.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>M.J.D. Powell, <a class="reference external" href="http://www.damtp.cam.ac.uk/user/na/NA_papers/NA2009_06.pdf">The BOBYQA algorithm for bound constrained optimization without derivatives</a>, Department of Applied Mathematics and Theoretical Physics, Cambridge England, technical report NA2009/06 (2009).</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>M.J.D. Powell, <a class="reference external" href="https://doi.org/10.1017/S0962492900002841">Direct search algorithms for optimization calculations</a>, Acta Numerica, Vol. 7(1998) pp. 287-336</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td>each verbosity level includes all the outputs from the lower verbosity options. Check <a class="reference internal" href="#the-files-table">the files table</a> for complete list of the output files.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="results-and-the-generated-files">
<h1><a class="toc-backref" href="#id19">6&nbsp;&nbsp;&nbsp;Results and the generated files</a></h1>
<p>slabcc writes its calculated energy correction values to the standard output as well as the output file. All reported energy values are in eV.</p>
<p>Depending on the verbosity level of your choice, you may get additional reports from each part of calculation in the standard output and/or extra output files.</p>
<div class="section" id="output-files">
<h2><a class="toc-backref" href="#id20">6.1&nbsp;&nbsp;&nbsp;Output files</a></h2>
<p>The parsed input variables or their default values and the calculation results will be written to the output file (by default: slabcc.out) You can change this file’s name using the <a class="reference internal" href="#command-line-parameters">command-line parameters</a>. A typical output file is shown below:</p>
<pre class="literal-block">
# Parameters read from the file or their default values:
charge_fraction = 1
charge_position = 0.5 0.5 0.37;
charge_sigma = 1
CHGCAR_charged = ../03-V_Cl_pos/CHGCAR
CHGCAR_neutral = ../02-V_Cl/CHGCAR
diel_in = 2.45
diel_out = 1
diel_taper = 1
extrapolate_grid_x = 1
extrapolate_steps_number = 4
extrapolate_steps_size = 0.5
interfaces = 0 0.375
LOCPOT_charged = ../03-V_Cl_pos/LOCPOT
LOCPOT_neutral = ../02-V_Cl/LOCPOT
normal_direction = z
optimize_algorithm = COBYLA
optimize_charge = 1
optimize_grid_x = 0.8
optimize_interfaces = 1
optimize_maxsteps = 0
optimize_maxtime = 0
optimize_tolerance = 0.001
slab_center = 0.5 0.5 0.25
verbosity = 5

[Optimized_parameters]
interfaces_optimized =  0.942000748357 0.455672787711
charge_sigma_optimized = 1.4132676877
charge_position_optimized = 0.501460639345 0.50145532106 0.385476689493;

[Results]
dV = -0.00291385176718
E periodic of model charge = 2.0404453156
E isolated of model charge = 2.59716677886
Energy correction for model charge (Eiso-Eper-q*dV) = 0.559635314929
</pre>
<p>Planar average files are written as a single column in plain text format and named as: &quot;slabcc_{1}{2}{XXX}.dat&quot; where:</p>
<ul class="simple">
<li>{1}: <strong>N</strong>: Neutral system, <strong>C</strong>: Charged system, <strong>D</strong>: Difference</li>
<li>{2}: <strong>X</strong>/<strong>Y</strong>/<strong>Z</strong>: Corresponds to the 1st, 2nd, and the 3rd axis in the input files</li>
<li>{XXX}: <strong>CHG</strong>: CHGCAR, <strong>POT</strong>: LOCPOT</li>
</ul>
<p id="the-files-table">All the possible output files and the minimum value of the verbosity parameter for activation of each are listed in the table below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="59%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">file name</th>
<th class="head">Description</th>
<th class="head">verbosity</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><code>slabcc_CXCHG.dat</code></td>
<td>Planar average of charged CHGCAR file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_CXPOT.dat</code></td>
<td>Planar average of charged LOCPOT file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_CYCHG.dat</code></td>
<td>Planar average of charged CHGCAR file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_CYPOT.dat</code></td>
<td>Planar average of charged LOCPOT file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_CZCHG.dat</code></td>
<td>Planar average of charged CHGCAR file in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_CZPOT.dat</code></td>
<td>Planar average of charged LOCPOT file in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_D.CHGCAR</code></td>
<td>Difference in the neutral and charged CHGCAR files</td>
<td>2</td>
</tr>
<tr><td><code>slabcc_D.LOCPOT</code></td>
<td>Difference in the neutral and charged LOCPOT files</td>
<td>2</td>
</tr>
<tr><td><code>slabcc_DIEL.dat</code></td>
<td>Generated dielectric profile (ε<sub>11</sub> ε<sub>22</sub>
ε<sub>33</sub>) along the normal axis to the surface</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DXCHG.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) CHGCAR file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DXPOT.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) LOCPOT file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DYCHG.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) CHGCAR file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DYPOT.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) LOCPOT file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DZCHG.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) CHGCAR file in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_DZPOT.dat</code></td>
<td>Planar average of extra charge (neutral and charged
difference) LOCPOT file in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_M.CHGCAR</code></td>
<td>CHGCAR of the Gaussian model</td>
<td>2</td>
</tr>
<tr><td><code>slabcc_M.LOCPOT</code></td>
<td>LOCPOT of the Gaussian model</td>
<td>2</td>
</tr>
<tr><td><code>slabcc_MXCHG.dat</code></td>
<td>Planar average of model charge in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_MXPOT.dat</code></td>
<td>Planar average of model potential in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_MYCHG.dat</code></td>
<td>Planar average of model charge in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_MYPOT.dat</code></td>
<td>Planar average of model potential in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_MZCHG.dat</code></td>
<td>Planar average of model charge in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_MZPOT.dat</code></td>
<td>Planar average of model potential in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NXCHG.dat</code></td>
<td>Planar average of neutral CHGCAR file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NXPOT.dat</code></td>
<td>Planar average of neutral LOCPOT file in X direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NYCHG.dat</code></td>
<td>Planar average of neutral CHGCAR file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NYPOT.dat</code></td>
<td>Planar average of neutral LOCPOT file in Y direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NZCHG.dat</code></td>
<td>Planar average of neutral CHGCAR file in Z direction</td>
<td>3</td>
</tr>
<tr><td><code>slabcc_NZPOT.dat</code></td>
<td>Planar average of neutral LOCPOT file in Z direction</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="faq">
<h1><a class="toc-backref" href="#id21">7&nbsp;&nbsp;&nbsp;FAQ</a></h1>
<ol class="arabic">
<li><p class="first"><strong>How to obtain the CHGCAR and LOCPOT files from VASP calculations?</strong> You can add the following tags to your INCAR file to get the LOCPOT and CHGCAR files:</p>
<pre class="literal-block">
LVTOT = .TRUE.
LVHAR = .TRUE.
LCHARG = .TRUE.
</pre>
</li>
</ol>
<blockquote>
After obtaining the files for your charged system, do the calculation again <em>without relaxing the geometry</em> to get the necessary files for the neutralized system.</blockquote>
<ol class="arabic simple" start="2">
<li><strong>Do I need to perform spin polarized calculation in VASP?</strong>  Although, the slabcc only reads the sum of both spins, but for proper description of the charge distribution in your system you may need to perform spin polarized calculation.</li>
<li><strong>How to speed-up the optimization process?</strong> Improving the initial guess, using a smaller grid for optimization (<tt class="docutils literal">optimize_grid_x</tt> &lt; 1), or increasing the optimization convergence criteria (<tt class="docutils literal">optimize_tolerance</tt>) can speed up the process but the accuracy of the obtained results must be checked.</li>
<li><strong>Why do I need to provide an initial guess for the parameters which will be optimized?</strong> The optimization algorithms used in slabcc are local error minimization algorithms. Their success and performance highly depend on the initial guess for the provided parameters.</li>
<li><strong>How should I decide on the initial guess for the parameters which will be optimized?</strong> As a rule of thumb, start by a single Gaussian charge as your model. Set its position to your expected position of the charge localization. Use the location of the surface atoms as the interface position.</li>
<li><strong>Can I turn off the optimization for the input parameters?</strong> Yes. But optimization ensures the model charge mimics the original localized charge in large distances as close as possible. If you turn off the optimization, you must be aware of the possible side-effects and definitely <a class="reference internal" href="#check">check your results</a>.</li>
</ol>
<ol class="arabic simple" start="7">
<li><strong>Can I run the slabcc on a computational cluster?</strong> Yes. BUT… Although slabcc hugely benefits from the multicore architecture of the computation nodes using OpenMP, it has not yet been parallelized using MPI. Therefore, It won’t use more than one machine at a time.</li>
<li><strong>Is slabcc free? Can I use its source code in my own software?</strong> slabcc is released under the 2-Clause BSD <a class="reference internal" href="#license">license</a> which permits this software to be modified, redistributed and/or used for commercial purposes provided that the source retains the original copyright owner's name (University of Bremen, M. Farzalipour Tabriz) and full text of the license (LICENSE.txt)</li>
<li><strong>How accurate are the slabcc results?</strong> The accuracy of the final results depends on various factors including the accuracy/grid-size of the input files and provided input parameters. The optimization algorithm used for parameters estimation is a non-linear local optimizer which means the result will highly depend on its initial conditions. Models with different number of Gaussian charges have different accuracy and may be compared with caution. In case of the models with multiple charges, the results must be vigorously checked. You must always do your own testing before using the results. There are a few <a class="reference internal" href="#known-issues-and-limitations">known issues and limitations</a> to the slabcc code and its algorithm. Also keep in mind that this is a free software and as the <a class="reference internal" href="#license">license</a> explicitly mentions: there is absolutely no warranty for its fitness for any particular purpose.</li>
</ol>
<ol class="arabic simple" id="check" start="10">
<li><strong>How can I check the slabcc results?</strong> By setting <tt class="docutils literal">verbosity &gt; 2</tt> in the input file, slabcc will write planar averaged files. You should compare the model charge distribution and potential in the direction normal to the surface and compare them to the original VASP results. For example, if z is the normal direction in you slab model (<tt class="docutils literal">normal_direction = z</tt>), then you should compare <code>slabcc_MZCHG.dat</code> and <code>slabcc_MZPOT.dat</code>, with <code>slabcc_DZCHG.dat</code> and <code>slabcc_DZPOT.dat</code>, respectively. Check <a class="reference internal" href="#the-files-table">the files table</a> for complete list of the output files.</li>
</ol>
<blockquote>
Another method to test the effectiveness of the charge correction is to increase the thickness of the vacuum in your slab model and check the energies. If the charge correction is done properly, the energy values must be independent of the (adequately large) vacuum thickness.</blockquote>
<ol class="arabic simple" id="cite" start="11">
<li><strong>How should I cite slabcc?</strong></li>
</ol>
</div>
<div class="section" id="known-issues-and-limitations">
<h1><a class="toc-backref" href="#id22">8&nbsp;&nbsp;&nbsp;Known issues and limitations</a></h1>
<ul>
<li><p class="first">Shape of the VASP files cell is limited to orthogonal cells with vectors along the main axis:</p>
<pre class="literal-block">
X 0 0
0 Y 0
0 0 Z
</pre>
</li>
<li><p class="first">BOBYQA algorithm cannot be used for optimization of the models with multiple localized Gaussian charges.</p>
</li>
<li><p class="first">Current extrapolation algorithm for the E<sub>isolated</sub> is not suitable for the monolayer models!</p>
</li>
</ul>
</div>
<div class="section" id="release-history">
<h1><a class="toc-backref" href="#id23">9&nbsp;&nbsp;&nbsp;Release history</a></h1>
<ul class="simple">
<li>2018-07-29: version 0.3 - First public release</li>
</ul>
</div>
<div class="section" id="copyright-and-attributions">
<h1><a class="toc-backref" href="#id24">10&nbsp;&nbsp;&nbsp;Copyright and attributions</a></h1>
<p>Copyright (c) 2018, University of Bremen, M. Farzalipour Tabriz</p>
<p>The source codes and all the documentations are available under The 2-Clause BSD License. For more information see <a class="reference internal" href="#license">license</a>.</p>
<div class="line-block">
<div class="line">This code uses several open source components each of which are located under a separate sub-directory in the <code>src/</code>. The copyright of these libraries belong to their respective owners. Any modification made to those codes is also published under the same license. We acknowledge and are grateful to these developers and maintainers for their valuable contributions to this software and more importantly to the free software society.</div>
<div class="line">The attributions are also present in the binary file and can be accessed using the <a class="reference internal" href="#command-line-parameters">command-line parameters</a>.</div>
</div>
<div class="section" id="included-libraries">
<h2><a class="toc-backref" href="#id25">10.1&nbsp;&nbsp;&nbsp;Included libraries</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://arma.sourceforge.net">Armadillo C++ Linear Algebra Library</a> licensed under the Apache License 2.0</li>
</ul>
<blockquote>
<ul class="simple">
<li>Copyright 2008 - 2018 Conrad Sanderson</li>
<li>Copyright 2008 - 2016 National ICT Australia (NICTA)</li>
<li>Copyright 2017 - 2018 Arroyo Consortium</li>
<li>Copyright 2017 - 2018 Data61, CSIRO</li>
<li>This product includes software developed by Conrad Sanderson</li>
<li>This product includes software developed at National ICT Australia (NICTA)</li>
<li>This product includes software developed at Arroyo Consortium</li>
<li>This product includes software developed at Data61, CSIRO</li>
</ul>
</blockquote>
<ul class="simple">
<li><a class="reference external" href="https://github.com/benhoyt/inih">inih</a> (INI Not Invented Here) licensed under the 3-clause BSD license</li>
</ul>
<blockquote>
<ul class="simple">
<li>© 2009, Ben Hoyt, <a class="reference external" href="https://github.com/benhoyt/inih/contributors">et al.</a></li>
</ul>
</blockquote>
<ul class="simple">
<li><a class="reference external" href="https://github.com/catchorg/Clara">clara</a> licensed under the Boost Software License 1.0</li>
</ul>
<blockquote>
<ul class="simple">
<li>© 2014, Phil Nash, Martin Horenovsky, <a class="reference external" href="https://github.com/catchorg/Clara/contributors">et al.</a></li>
</ul>
</blockquote>
<ul class="simple">
<li><a class="reference external" href="https://shiftedbits.org/2011/01/30/cubic-spline-interpolation/">spline</a> (Cubic Spline Interpolation) licensed under the Beer-Ware License 42</li>
</ul>
<blockquote>
<ul class="simple">
<li>© 2011, Devin Lane</li>
</ul>
</blockquote>
<ul class="simple">
<li><a class="reference external" href="https://nlopt.readthedocs.io">NLOPT</a> licensed under the GNU LGPL</li>
</ul>
<blockquote>
<ul class="simple">
<li>© 2007-2014 Massachusetts Institute of Technology</li>
</ul>
</blockquote>
</div>
<div class="section" id="linked-libraries">
<h2><a class="toc-backref" href="#id26">10.2&nbsp;&nbsp;&nbsp;Linked libraries</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://www.fftw.org">FFTW</a> licensed under GNU General Public License</li>
<li><a class="reference external" href="http://www.openblas.net">OpenBLAS</a> licensed under the 3-clause BSD license</li>
</ul>
</div>
<div class="section" id="license">
<h2><a class="toc-backref" href="#id27">10.3&nbsp;&nbsp;&nbsp;License</a></h2>
<p>Copyright (c) 2018, University of Bremen, M. Farzalipour Tabriz</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol class="arabic simple">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</div>
</div>
 </div>

</div>
</body>
</html>
